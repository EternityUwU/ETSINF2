Ejercicio 1. Abre una ventana de DOS y ejecuta la orden ipconfig /all. De toda la
información que se te muestra, ¿qué parámetros están relacionados con el diálogo
DHCP inicial que se ha producido en el arranque del sistema? ¿Cuándo se ha obtenido
la concesión de la dirección IP? ¿Cuándo caduca?


Ejercicio 2. Ponemos en marcha el analizador de protocolos Wireshark e iniciamos una
captura filtrando el tráfico UDP que utilice el puerto 67. A continuación, utilizamos el
comando ipconfig /release para liberar la información IP que tiene nuestro ordenador y
después el comando ipconfig /renew para volver a obtener dirección IP, mientras está
en marcha la captura con el Wireshark. Una vez finalizado este proceso paramos la
captura.

Ejercicio 3. Descárgate del Poliformat la captura Captura1Practica3.pcap y ábrela
con el programa Wireshark.

    a) Nos centramos en primer lugar en el primer mensaje DHCP que interviene en
    el proceso de obtención de dirección IP: DHCPDISCOVER. Basándote en la
    información obtenida, ¿qué servicio utiliza DHCP, TCP o UDP? Mirando las
    direcciones IP origen y destino del datagrama de este primer mensaje DHCP que te
    aparece, ¿podrías justificar la elección de DHCP por un servicio sin conexión?

    b) Selecciona el mensaje DHCPDiscover y b u s c a la información para rellenar
    los siguientes campos (se trata de información que corresponde a distintos niveles de la
    arquitectura y está en diferentes cabeceras):

    Tipo de Mensaje (en el campo de opciones DHCP)      |
    Dir. IP origen del datagrama (en cab. IP)           |
    Dir. IP destino del datagrama (en cab. IP)          |
    Puertos origen y destino (en cab. UDP)              |
    Id. Transacción (en cabecera DHCP)                  |
    Campo dir. IP Cliente (en cabecera DHCP)            |
    Campo Tu dirección IP (en cabecera DHCP)            |
    Campo Dir. IP del Agente Retransmisor (cab. DHCP    |

    c) En este mensaje el nodo no solicita una dirección IP cualquiera, sino que pide
    una dirección concreta que está asociada a su dirección física. ¿En qué campo del
    mensaje se hace esta solicitud?


    d) Entre las distintas opciones aparece la lista de parámetros que el cliente solicita
    al servidor. Cita las cuatro primeras.

Ejercicio 4. A continuación podemos ver los mensajes de ofrecimiento de los
servidores: DHCPOFFER.

    a) ¿Cuántos mensajes de este tipo hay? ¿Qué conclusiones podemos sacar acerca
    del número de servidores DHCP disponibles en la red de la UPV?

    b) Busca en el primer mensaje DHCPOffer la información para rellenar los
    siguientes campos:

    c) ¿En qué campo de los mensajes DHCPOffer aparece la mayor parte de la
    información de configuración IP que el Servidor ofrece al Cliente? Comprueba todo
    lo que ofrecen los servidores DHCP. En particular, fíjate en el valor del campo
    “DHCP Server Identifier”. ¿Coincide con alguno de los que has anotado en la tabla?

    d) Busca y anota en cualquiera de los mensajes DHCPOffer la siguiente información
    IP que los servidores DHCP están ofreciendo al equipo que ha solicitado la
    configuración IP: dirección IP ofrecida, máscara de subred, router asignado y nombre
    de dominio.

    e) A quién pertenece la dirección IP origen de estos datagramas (DHCPOFFER).
    ¿Qué conclusiones puedes sacar acerca de la localización de los servidores DHCP
    de la UPV con respecto a la subred en la que está el cliente?

    f) Compara los valores del campo “DHCP Server Identifier” de los mensajes
    DHCPOffer restantes que aparecen en la captura. ¿Cuántos servidores DHCP distintos
    están contestando?

Ejercicio 5. Analizamos ahora el mensaje DHCPREQUEST con el que contesta
el cliente a uno de los servidores que le ha realizado una oferta.

    Tipo de Mensaje (en el campo de opciones DHCP)
    Dir. IP origen del datagrama (en cab. IP)
    Dir. IP destino del datagrama (en cab. IP)
    Puertos origen y destino (en cab. UDP)
    Id. Transacción (en cabecera DHCP)
    Campo dir. IP Cliente (en cabecera DHCP)
    Campo Tu dirección IP (en cabecera DHCP)
    Campo Dir. IP del Agente Retransmisor (cab. DHCP)

    b) Busca entre las distintas opciones del mensaje la dirección IP del servidor DHCP al
    que el cliente está contestando.

Ejercicio 6. Por último, tenemos los mensajes DHCPACK de los servidores de la
UPV que confirman la obtención de la dirección IP por parte del cliente. Busca en estos
mensajes las direcciones IP de los diferentes servidores DHCP de la UPV.

Ejercicio 7. Y para terminar, vamos a analizar una nueva captura con el Wireshark con
el fin de estudiar el tráfico DHCP que se genera cuando un nodo libera su dirección IP.
Para ello abrimos la captura Captura2Practica3.pcap (la hemos obtenido ejecutando
el comando: ipconfig /release).

¿Qué tipo de mensaje DHCP interviene en este proceso? ¿Quién es el origen y el
destino de este mensaje? ¿Hay contestación a este mensaje?

